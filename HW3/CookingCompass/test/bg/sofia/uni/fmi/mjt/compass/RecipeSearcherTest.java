package bg.sofia.uni.fmi.mjt.compass;
import bg.sofia.uni.fmi.mjt.exception.BadRequestException;
import bg.sofia.uni.fmi.mjt.exception.FailedRequestSendingException;
import bg.sofia.uni.fmi.mjt.exception.ForbiddenErrorException;
import bg.sofia.uni.fmi.mjt.queryparams.Health;
import bg.sofia.uni.fmi.mjt.queryparams.MealType;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.mockito.ArgumentCaptor;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.junit.jupiter.MockitoExtension;

import java.io.File;
import java.io.IOException;
import java.net.URISyntaxException;
import java.net.http.HttpClient;
import java.net.http.HttpRequest;
import java.net.http.HttpResponse;
import java.util.List;
import java.util.Scanner;
import java.util.Set;

import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertThrows;
import static org.junit.jupiter.api.Assertions.assertTrue;
import static org.mockito.ArgumentMatchers.any;
import static org.mockito.ArgumentMatchers.argThat;
import static org.mockito.ArgumentMatchers.eq;
import static org.mockito.Mockito.lenient;
import static org.mockito.Mockito.mock;
import static org.mockito.Mockito.times;
import static org.mockito.Mockito.verify;
import static org.mockito.Mockito.when;

@ExtendWith(MockitoExtension.class)
public class RecipeSearcherTest {
    @Mock
    private HttpClient client;

    @InjectMocks
    private RecipeSearcher searcher;

    @Test
    void testGetRecipesThrowsBadRequestExceptionWhenStatusCodeIs400() throws IOException, InterruptedException {
        HttpResponse<Object> mockHttpResponse = mock(HttpResponse.class);
        when(mockHttpResponse.statusCode()).thenReturn(400);
        when(client.send(any(), any())).thenReturn(mockHttpResponse);
        List<String> keyWords = List.of("beef", "mushroom", "cream");
        Set<Health> healthSet = Set.of(Health.ALCOHOL_FREE, Health.DAIRY_FREE, Health.PORK_FREE);
        Set<MealType> mealTypes = Set.of(MealType.DINNER, MealType.LUNCH);
        assertThrows(BadRequestException.class, () -> searcher.getRecipes(keyWords, healthSet, mealTypes),
            "Get Recipes should throw BadRequestException when status code of HttpResponse is 400!");
    }

    @Test
    void testGetRecipesThrowsForbiddenErrorException() throws IOException, InterruptedException {
        HttpResponse<Object> mockHttpResponse = mock(HttpResponse.class);
        when(mockHttpResponse.statusCode()).thenReturn(403);
        when(client.send(any(), any())).thenReturn(mockHttpResponse);
        List<String> keyWords = List.of("beef", "mushroom", "cream");
        Set<Health> healthSet = Set.of(Health.ALCOHOL_FREE, Health.DAIRY_FREE, Health.PORK_FREE);
        Set<MealType> mealTypes = Set.of(MealType.DINNER, MealType.LUNCH);
        assertThrows(ForbiddenErrorException.class, () -> searcher.getRecipes(keyWords, healthSet, mealTypes),
            "Get Recipes should throw ForbiddenErrorException when status code of HttpResponse is 403!");
    }

    @Test
    void testGetRecipesThrowsFailedRequestSendingException() throws IOException, InterruptedException {
        when(client.send(any(), any())).thenThrow(new IOException("Simulated IOException"));
        List<String> keyWords = List.of("beef", "mushroom", "cream");
        Set<Health> healthSet = Set.of(Health.ALCOHOL_FREE, Health.DAIRY_FREE, Health.PORK_FREE);
        Set<MealType> mealTypes = Set.of(MealType.DINNER, MealType.LUNCH);
        assertThrows(FailedRequestSendingException.class, () -> searcher.getRecipes(keyWords, healthSet, mealTypes),
            "Get Recipes should throw FailedRequestSendingException when there is an IOException during the sending!");
    }
    @Test
    void testGetRecipesSuccessfullyWithNoRecipesOnNextPage()
        throws IOException, InterruptedException, FailedRequestSendingException,
        ForbiddenErrorException, BadRequestException, URISyntaxException {
        String uriStr = "https://api.edamam.com/api/recipes/v2?type=public&q=beef%20mushroom%20cream&app_id=1006fbf6&app_key=82b0fad1d7c56f8e8edc5d563f4caa25&health=alcohol-free&health=dairy-free&health=pork-free&mealType=Dinner&mealType=Lunch";
//        HttpRequest request = mock(HttpRequest.class);
//        when(request.uri()).thenReturn(new URI(uriStr));
        Scanner scanner = new Scanner(new File("beefMushroomResponse.txt"));
        String mockApiResponseStr = scanner.nextLine();
        HttpResponse<String> mockHttpResponse = mock(HttpResponse.class);
        when(mockHttpResponse.statusCode()).thenReturn(200);
        when(mockHttpResponse.body()).thenReturn(mockApiResponseStr);

        ArgumentCaptor<HttpRequest> captor = ArgumentCaptor.forClass(HttpRequest.class);
        // Configuring the mock behavior
        when(client.send(captor.capture(), eq(HttpResponse.BodyHandlers.ofString()))).thenReturn(mockHttpResponse);

        List<String> keyWords = List.of("beef", "mushroom", "cream");
        Set<Health> healthSet = Set.of(Health.ALCOHOL_FREE, Health.DAIRY_FREE, Health.PORK_FREE);
        Set<MealType> mealTypes = Set.of(MealType.DINNER, MealType.LUNCH);
        String expected = "[Recipe[label=Kobe Beef and Oyster Mushroom Meatballs, dietLabels=[], healthLabels=[Sugar-Conscious, Dairy-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Crustacean-Free, Celery-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, No oil added, Sulfite-Free, Kosher], ingredientLines=[14 cups minced oyster mushrooms, 9 cups panko bread crumbs, 1/4 cup minced garlic, 3 tablespoons ground black pepper, 3 tablespoons kosher salt, 5 pounds ground Kobe beef, at room temperature, 3 tablespoons dried parsley], totalWeight=4088.616172787212, cuisineType=[eastern europe], mealType=[lunch/dinner], dishType=[main course]], Recipe[label=Creamy Mushroom Barley Soup, dietLabels=[], healthLabels=[Pescatarian, Mediterranean, Dairy-Free, Wheat-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Red-Meat-Free, Crustacean-Free, Celery-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, No oil added, Sulfite-Free, Kosher], ingredientLines=[? c. mushroom barley pilaf, 1 c. strong beef, chicken or vegetable bouillon, Hot sauce to taste (optional)], totalWeight=320.0, cuisineType=[american], mealType=[lunch/dinner], dishType=[soup]], Recipe[label=Creamy Beef Tips with Mushrooms, dietLabels=[], healthLabels=[Dairy-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Crustacean-Free, Celery-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, No oil added, Sulfite-Free], ingredientLines=[1 (14 ounce) can coconut milk, 1 cup beef broth, 8 ounces portobello mushrooms, cleaned and sliced, 1 green bell pepper, cut into strips, 1 yellow onion, cut into strips, 1 teaspoon sea salt, 1 1/2 pounds beef sirloin tips, cubed, 1 (16 ounce) package linguine pasta], totalWeight=2243.813489305802, cuisineType=[mediterranean], mealType=[lunch/dinner], dishType=[main course]], Recipe[label=Coconut Cream Mushroom Soup in Da' Crock Pot, dietLabels=[Low-Carb], healthLabels=[Sugar-Conscious, Keto-Friendly, Dairy-Free, Gluten-Free, Wheat-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Crustacean-Free, Celery-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher, Immuno-Supportive], ingredientLines=[1 cup boiling water, 1 1?2 lbs fresh mushrooms, trimmed and sliced (mixed -your choice of varieties), 2 onions, finely chopped, 4 garlic cloves, minced, 1?2 teaspoon dried thyme leaves or 2 sprigs fresh thyme, 1 teaspoon sea salt, 1?2 teaspoon black peppercorns (cracked), 1 bay leaf, 4 cups vegetable broth or 4 cups beef broth, 1 cup coconut milk (homemade -see my recipe), 4 tablespoons virgin coconut oil], totalWeight=2374.680958166913, cuisineType=[american], mealType=[lunch/dinner], dishType=[soup]], Recipe[label=Beef and Mushrooms with Pasta, dietLabels=[High-Fiber], healthLabels=[Dairy-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Fish-Free, Shellfish-Free, Pork-Free, Crustacean-Free, Celery-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free], ingredientLines=[2 tablespoons olive oil, 3.333 cups rump or sirloin Steak (cut into strips), 1 onion (chopped), 2 cups button Mushrooms (sliced), 1 cup Oat cream (or soy), 1 tablespoon tomato puree, 1 teaspoon Dijon mustard, 3 teaspoons freshly chopped thyme, salt, freshly ground Black pepper, 1 lemon (juice), 14 ounces wide ribbon pasta], totalWeight=1806.4334446721252, cuisineType=[italian], mealType=[lunch/dinner], dishType=[main course]], Recipe[label=Slow Cooker Beef Stroganoff (Paleo, Dairy-Free, Whole 30) recipes, dietLabels=[High-Protein, Low-Carb], healthLabels=[Sugar-Conscious, Dairy-Free, Gluten-Free, Wheat-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Fish-Free, Shellfish-Free, Pork-Free, Crustacean-Free, Celery-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, No oil added, Kosher], ingredientLines=[1.5 lbs lean stew beef, ? large white onion, chopped, 3 cloves garlic, minced, 10 oz sliced mushrooms, 1? cup beef broth, ? cup coconut amines or GF tamari soy sauce, ? cup red wine vinegar, ? tsp onion powder, ? tsp garlic powder, ? cup canned coconut milk or coconut cream, 3 tbsp arrowroot starch*, 2 tbsp water], totalWeight=1648.9573158128114, cuisineType=[eastern europe], mealType=[lunch/dinner], dishType=[main course]], Recipe[label=Paleo Beef Stroganoff, dietLabels=[Low-Carb, Low-Sodium], healthLabels=[Sugar-Conscious, Keto-Friendly, Dairy-Free, Gluten-Free, Wheat-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Crustacean-Free, Celery-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher], ingredientLines=[1 small tomato, 1 clove garlic, 1 brown onion, Halved, 60 g coconut oil, 1 tablespoon paprika ground, 500 g Beef, Cut into strips, 3/4 can coconut cream, About 300ml, 1 tablespoon Golden Syryp, 1 tablespoon GF Cornflour, Optional, keep out for paleo, 1 pinch salt and pepper to taste, Quick grind, 2 carrots, Peeled and sliced, 2 leaves Kale, Cut from the stem, 1/2 red capsicum, Sliced, 100 g Mushrooms sliced, About a cup full], totalWeight=1453.6989583338798, cuisineType=[eastern europe], mealType=[lunch/dinner], dishType=[main course]], Recipe[label=Arabic Beef Rice Recipe, dietLabels=[], healthLabels=[Sugar-Conscious, Dairy-Free, Gluten-Free, Wheat-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Crustacean-Free, Celery-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher], ingredientLines=[1 Leek (washed, diced), 1 Pack Lean Beef Mince, 4 Mushrooms (diced), 1/4 Cup Creamed/Sieved Tomatoes, Few Drops Water, 1 Garlic Clove, 2 Carrots (roughly grated large), 3 Handfuls Freshly Washed Spinach Leaves, Large Pinch Dried Chives, 1/2 tsp Kalonji Seeds, 1 tsp Pomegranate Seeds, Pinch Cinnamon, 1/2 tsp Dried Thyme, 1 tsp Cumin Seeds, 1/4 tsp Dried Basil, 1 tsp Paprika, Salt and Pepper to Season, Freshly Cooked Basmati Rice (2/3 - 1 Cup Dried Rice), Olive Oil], totalWeight=627.9594133812564, cuisineType=[mediterranean], mealType=[lunch/dinner], dishType=[main course]], Recipe[label=Crock Pot Beef Rogan Josh, dietLabels=[Low-Carb], healthLabels=[Dairy-Free, Gluten-Free, Wheat-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Crustacean-Free, Celery-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Kosher], ingredientLines=[1 lb sliced chuck steak, 1 large onion, fairly thinly sliced, 3 garlic cloves, sliced, 3 tablespoons rogan josh curry paste, 1 (14 ounce) can plum tomatoes, 1 tablespoon mango chutney, 2 tablespoons creamed coconut, 6 ounces small mushrooms, quartered, 3 tablespoons canola oil, 1 beef stock cube, 1 1?2 cups boiling water], totalWeight=1658.065187249831, cuisineType=[central europe], mealType=[lunch/dinner], dishType=[main course]], Recipe[label=Lamb Quinoa and Veggie Dinner, dietLabels=[Low-Carb, Low-Sodium], healthLabels=[Sugar-Conscious, Mediterranean, Dairy-Free, Gluten-Free, Wheat-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Crustacean-Free, Celery-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher], ingredientLines=[1 cup cooked quinoa (or brown rice), 300g Lamb (or lentils/beef/chicken), diced into small chunks, 2 zucchini, sliced, 1/2 brown onion, finely sliced, 1/2 cup green peas, 1/2 cup broccoli florets, 1 cup sweet potato, diced, 1 small tin creamed corn (or make your own), 3 button mushrooms, peeled, chopped, 1 parsnip, peeled, chopped, 1 tbs chia seeds (optional), 2 cups salt reduced vegetable stock* (or make your own), Extra virgin olive oil], totalWeight=1961.8228, cuisineType=[middle eastern], mealType=[lunch/dinner], dishType=[starter]], Recipe[label=Thick and Savory Chili, dietLabels=[High-Fiber], healthLabels=[Dairy-Free, Gluten-Free, Wheat-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Crustacean-Free, Celery-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, No oil added, Kosher], ingredientLines=[2 pounds lean ground beef, 1 large sweet onion (such as Vidalia�), diced, 1 tablespoon garlic powder, 2 (15 ounce) cans whole tomatoes, cut into chunks, 2 (15 ounce) cans mild chili beans, 1 (15 ounce) can tomato sauce, 1 (15 ounce) can kidney beans, drained and rinsed, 1 cup ketchup, 1 (6 ounce) can tomato paste, 2 (6 ounce) jars mushrooms, drained, 1/4 cup chili powder, or to taste, 2 teaspoons white sugar (optional), 1 1/2 teaspoons salt, 1 teaspoon ground black pepper], totalWeight=4675.083237500541, cuisineType=[american], mealType=[lunch/dinner], dishType=[main course]], Recipe[label=Porcupine Meatballs, dietLabels=[], healthLabels=[Dairy-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Shellfish-Free, Pork-Free, Crustacean-Free, Celery-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, No oil added, Sulfite-Free, Kosher], ingredientLines=[1 egg, lightly beaten, 1/2 cup uncooked instant rice, 2 tablespoons finely chopped onion, 1 tablespoon minced fresh parsley, 1/2 teaspoon salt, 1/4 teaspoon pepper, 1 pound lean ground beef, 1 (10.75 ounce) can condensed tomato soup, undiluted, 1 cup water, 1 teaspoon Worcestershire sauce], totalWeight=1168.5618292727438, cuisineType=[british], mealType=[lunch/dinner], dishType=[main course]], Recipe[label=Old Fashioned Mushroom Barley Soup, dietLabels=[], healthLabels=[Sugar-Conscious, Kidney-Friendly, Keto-Friendly, Dairy-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Shellfish-Free, Pork-Free, Crustacean-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher], ingredientLines=[3 tablespoons olive oil, divided, 12 ounces medium button mushrooms, sliced, 12 ounces boneless beef chuck cut into a small dice, 1 large onion, diced, 1 stalk celery cut into a small dice, 1 carrot cut into a small dice, 2 cloves minced garlic, 1 bay leaf, 1/4 teaspoon dried thyme leaves, 1 teaspoon salt, 1 teaspoon black pepper, 2 cups beef broth, 8 cups chicken broth, 1 cup quick cooking pearl barley ( add an extra 1/2 cup for a thicker soup), 2 tablespoons Worcestershire sauce], totalWeight=3605.638555, cuisineType=[american], mealType=[lunch/dinner], dishType=[soup]], Recipe[label=Turkish \"Lady's Tight\" Meatballs, dietLabels=[Low-Carb, Low-Sodium], healthLabels=[Sugar-Conscious, Dairy-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Crustacean-Free, Celery-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher], ingredientLines=[1 pound ground beef, 1/4 cup cooked rice, 1 piece onion, 1 handful parsley, 4 pieces eggs, 1/4 teaspoon all spice, 1/4 teaspoon cumin, 1/2 teaspoon dried mint, 1 cup flour, 1 pinch grated garlic, 2 cups olive oil], totalWeight=1356.019453333558, cuisineType=[middle eastern], mealType=[lunch/dinner], dishType=[main course]], Recipe[label=John Legend�s Hearty Chili, dietLabels=[High-Fiber], healthLabels=[Dairy-Free, Gluten-Free, Wheat-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Crustacean-Free, Celery-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, No oil added, Kosher], ingredientLines=[1 Pound ground beef, 1 medium onion, chopped, 1 Cup mushrooms, chopped, 2 Tablespoons seasoned salt, preferably Lawry�s, 3 Tablespoons chili powder, 1 Teaspoon ground red pepper, 3 garlic cloves, minced, 2 Cups water, 2 15-ounce cans tomato sauce, 2 15-ounce cans kidney beans, drained and rinsed, 2 Tablespoons light brown sugar], totalWeight=2861.9693971665174, cuisineType=[american], mealType=[lunch/dinner], dishType=[main course]]]";
        var result =  searcher.getRecipes(keyWords, healthSet, mealTypes);
        assertEquals(expected, result.toString(), "Collection of recipes should be the same as the expected!");

        verify(client).send(captor.capture(), any());
        assertTrue(captor.getValue().uri().toString().contains("beef"), "Captor should contains beef in the uri of the request!");
        assertTrue(captor.getValue().uri().toString().contains("mushroom"), "Captor should contains mushroom in the uri of the request!");
        assertTrue(captor.getValue().uri().toString().contains("cream"), "Captor should contains cream in the uri of the request!");
        assertTrue(captor.getValue().uri().toString().contains("alcohol-free"), "Captor should contains alcohol-free in the uri of the request!");
        assertTrue(captor.getValue().uri().toString().contains("pork-free"), "Captor should contains pork-free in the uri of the request!");
        assertTrue(captor.getValue().uri().toString().contains("dairy-free"), "Captor should contains dairy-free in the uri of the request!");
        assertTrue(captor.getValue().uri().toString().contains("Lunch"), "Captor should contains Lunch in the uri of the request!");
        assertTrue(captor.getValue().uri().toString().contains("Dinner"), "Captor should contains Dinner in the uri of the request!");
    }

    @Test
    void testGetRecipesSuccessfullyWhenThereIsNextPageInTheResponse()
        throws IOException, InterruptedException, FailedRequestSendingException, ForbiddenErrorException,
        BadRequestException {
        Scanner scannerFirstPage = new Scanner(new File("chickenTomatoResponseFirstPage.txt"));
        String mockApiResponseStrFirstPage = scannerFirstPage.nextLine();
        HttpResponse<Object> mockHttpResponse = mock(HttpResponse.class);
        when(mockHttpResponse.statusCode()).thenReturn(200);
        when(mockHttpResponse.body()).thenReturn(mockHttpResponse);

        ArgumentCaptor<HttpRequest> captor = ArgumentCaptor.forClass(HttpRequest.class);
        // Configuring the mock behavior
        when(client.send(any(), any())).thenReturn(mockHttpResponse);

        Scanner scannerSecondPage = new Scanner(new File("chickenTomatoResponseSecondPage.txt"));
        String mockApiResponseStrSecondPage = scannerSecondPage.nextLine();
        when(mockHttpResponse.statusCode()).thenReturn(200);
        when(mockHttpResponse.body()).thenReturn(mockApiResponseStrSecondPage);

        when(client.send(any(), any())).thenReturn(mockHttpResponse);

        List<String> keyWords = List.of("chicken", "tomato");
        Set<Health> healthSet = Set.of(Health.ALCOHOL_FREE, Health.DAIRY_FREE, Health.PORK_FREE);
        Set<MealType> mealTypes = Set.of(MealType.DINNER, MealType.LUNCH);

        String expected = "[Recipe[label=Cod In Sweet Tomato Sauce II, dietLabels=[High-Protein], healthLabels=[Dairy-Free, Gluten-Free, Wheat-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Shellfish-Free, Pork-Free, Red-Meat-Free, Crustacean-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Kosher], ingredientLines=[2 teaspoons olive oil, 2 cups chopped onions, 1 cup chopped red bell peppers, 1 cup chopped celery, 2 cups chopped tomatoes, 2 teaspoons minced garlic, 1 teaspoon sugar, 1/4 cup reduced-sodium chicken broth, 1/4 teaspoon salt, 1/4 teaspoon ground black pepper, 1 1/2 pounds cod fillets], totalWeight=1629.263555, cuisineType=[french], mealType=[snack, lunch/dinner], dishType=[condiments and sauces]], Recipe[label=Fennel, Cherry Tomato & Chicken Salad with Toasted Pistachios recipes, dietLabels=[Low-Carb], healthLabels=[Keto-Friendly, Paleo, Mediterranean, DASH, Dairy-Free, Gluten-Free, Wheat-Free, Egg-Free, Peanut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Red-Meat-Free, Crustacean-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher], ingredientLines=[A few stems of fennel from the bulb you'll use for the salad below, 1 slice onion, 1 small stalk celery, 2 boneless skinless chicken thighs (about 10 ounces), salt, pepper, 2 cloves garlic, grated on a Microplane or minced with salt, 2 teaspoons red wine vinegar, 1 teaspoon Dijon mustard, 2 tablespoons olive oil, salt, 1 bulb fennel, core removed and very thinly sliced, preferably on a mandoline, ? pint cherry tomatoes, A few handfuls of lettuce--green or red leaf, or romaine, chopped, ? cup toasted pistachios, coarsely chopped], totalWeight=853.8337653398946, cuisineType=[mediterranean], mealType=[lunch/dinner], dishType=[salad]], Recipe[label=Chicken & Brown Rice, dietLabels=[], healthLabels=[Sugar-Conscious, DASH, Dairy-Free, Gluten-Free, Wheat-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Red-Meat-Free, Crustacean-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher], ingredientLines=[1 1/2 tsp olive oil, 1 lb chicken breast (or 1 c cooked and chopped), 1 large carrot, diced, 1 celery stalk, diced, 1/4 leek or scallion, thinly sliced, 1/3 C brown rice, 2 tsp thyme, 1 can (14.5 oz) no-salt-added diced tomatoes, including juice, 6 C low-sodium chicken stock], totalWeight=2491.816010868056, cuisineType=[french], mealType=[lunch/dinner], dishType=[main course]], Recipe[label=Soup Recipe: Italian Bread & Tomato Soup (Ribollita), dietLabels=[High-Fiber], healthLabels=[Mediterranean, Dairy-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Red-Meat-Free, Crustacean-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher], ingredientLines=[2 tablespoons olive oil, 4 large garlic cloves, chopped, 1 medium onion, chopped, 2 medium carrots, peeled and chopped, 2 large celery ribs, chopped, 1 dried bay leaf, 2 15.5-ounce cans cannellini beans, with their liquid, 6 cups vegetable or chicken stock, 1 15-ounce can (1 3/4 cups) tomato pure?, 9 ounces day-old bread, torn in pieces (about 3 cups), 1/4 cup fresh basil, chopped], totalWeight=3384.823771875, cuisineType=[italian], mealType=[lunch/dinner], dishType=[soup]], Recipe[label=Chicken & Sausage Gumbo, dietLabels=[], healthLabels=[Sugar-Conscious, Dairy-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Red-Meat-Free, Crustacean-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher], ingredientLines=[? cup all-purpose flour, 1 (14.5 ounce) can reduced-sodium chicken broth, 12 ounces skinless, boneless chicken breast halves, cut into cubes, 1 large red or green sweet pepper, seeded and coarsely chopped, 1 large onion, coarsely chopped, 1 cup water, 1 stalk celery, sliced, 4 cloves garlic, minced, 1 teaspoon salt-free Cajun seasoning, 1 14.8-ounce pouch cooked brown rice, 1 10-ounce package frozen cut okra, 8 ounces smoked turkey sausage, sliced, 1 large tomato, chopped], totalWeight=2324.631629886409, cuisineType=[american], mealType=[lunch/dinner], dishType=[main course]], Recipe[label=Chicken Chili Monterey, dietLabels=[], healthLabels=[Mediterranean, Dairy-Free, Gluten-Free, Wheat-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Red-Meat-Free, Crustacean-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher], ingredientLines=[1 tablespoon cooking oil, 1 cup chopped onion, 1 cup coarsely chopped carrots, 1 cup sliced celery, 1? cups chopped tart apples, 2 teaspoons curry powder, or more to taste, ? teaspoon salt, 3 cups reduced-sodium chicken broth, 3 cups water, 1 (14.1 ounce) can low-sodium stewed tomatoes, 2 cups chopped cooked chicken or turkey], totalWeight=2663.326329710318, cuisineType=[american], mealType=[lunch/dinner], dishType=[main course]], Recipe[label=Moroccan chicken soup from Cayenne, dietLabels=[], healthLabels=[Mediterranean, Dairy-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Red-Meat-Free, Crustacean-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher], ingredientLines=[1 tablespoon olive oil, 1 red onion, finely chopped, 2 cloves garlic, finely chopped, 2 carrots, diced, 1 stalk celery, diced, 1 cooked boneless and skinless chicken breast, diced (about 2 cups), 1 cup cooked garbanzo beans, 1/3 cup diced tomato, 2 bay leaves, 1 teaspoon basil, 1/2 teaspoon curry powder, 1/2 teaspoon cinnamon, Salt and pepper to taste, 1/4 cup cracked wheat no. 1 (fine grind), 4 to 5 cups chicken broth, more if desired], totalWeight=2141.588542351933, cuisineType=[middle eastern], mealType=[lunch/dinner], dishType=[soup]], Recipe[label=Double-Dark Chicken Noodle Soup recipes, dietLabels=[Low-Carb], healthLabels=[Mediterranean, Dairy-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Red-Meat-Free, Crustacean-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher], ingredientLines=[1 leek, Stems from ? bunch parsley, 6 sprigs thyme, 2 bay leaves, 1 tablespoon vegetable oil, 3 pounds chicken wings, 1 onion, unpeeled, quartered, 3 carrots, peeled, 2 celery stalks, 2 garlic cloves, 1 tablespoon tomato paste, ? teaspoon black peppercorns, ground black pepper, kosher salt, 2? pounds bone-in chicken thighs, skin removed, 8 ounces carrots, peeled, sliced ?� thick, 8 ounces pearl onions, peeled, halved through root, 8 ounces egg noodles, fresh chervil], totalWeight=3775.133096774682, cuisineType=[asian], mealType=[lunch/dinner], dishType=[soup]], Recipe[label=Butcher Shop Chicken, dietLabels=[Low-Carb], healthLabels=[Paleo, Mediterranean, Dairy-Free, Gluten-Free, Wheat-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Red-Meat-Free, Crustacean-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher], ingredientLines=[2 shallots, 1 carrot, 1 celery rib, 2 bone-in chicken breast halves, 2 whole chicken legs, 3 tbsp. extra-virgin olive oil, kosher salt, Black pepper, 1? tsp. finely chopped rosemary leaves, 1 tsp. finely chopped thyme leaves, 3 tbsp. finely chopped basil leaves, 1 clove garlic, 2 pt. grape tomatoes, ? tsp. crushed red pepper, 1 tsp. sherry vinegar], totalWeight=1749.6119000728665, cuisineType=[american], mealType=[lunch/dinner], dishType=[main course]], Recipe[label=Double-Dark Chicken Noodle Soup, dietLabels=[Low-Carb], healthLabels=[Mediterranean, Dairy-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Red-Meat-Free, Crustacean-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher], ingredientLines=[1 leek, Stems from 1/2 bunch parsley, 6 sprigs thyme, 2 bay leaves, 1 tablespoon vegetable oil, 3 pounds chicken wings, 1 onion, unpeeled, quartered, 3 carrots, peeled, 2 celery stalks, 2 garlic cloves, 1 tablespoon tomato paste, 1/2 teaspoon black peppercorns, Kosher salt, freshly ground pepper, 2 1/2 pounds bone-in chicken thighs, skin removed, 8 ounces carrots, peeled, sliced 1/2\" thick, 8 ounces pearl onions, peeled,, halved through root, 8 ounces egg noodles, Fresh chervil (for serving)], totalWeight=3763.938592151659, cuisineType=[asian], mealType=[lunch/dinner], dishType=[soup]], Recipe[label=Chicken Spaghetti Dinner, dietLabels=[], healthLabels=[Mediterranean, Dairy-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Red-Meat-Free, Crustacean-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher], ingredientLines=[1 green pepper, chopped, 1 cup diced celery, 2 large onions, chopped, 3 cloves garlic, chopped, 1/2 cup cooking oil, 1 can (16 ounces) tomato puree, 2 cans (6 ounces each) tomato paste, 2 puree cans water (32 ounces), 1 cup up broiler-fryer, 1 teaspoon cinnamon, 1 teaspoon salt, 1/2 teaspoon pepper, 1/2 teaspoon allspice, 8 ounces spaghetti], totalWeight=2714.0564613888887, cuisineType=[italian], mealType=[lunch/dinner], dishType=[main course]], Recipe[label=Garden Tomato Soup With Cumin, dietLabels=[High-Fiber], healthLabels=[Dairy-Free, Gluten-Free, Wheat-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Red-Meat-Free, Crustacean-Free, Celery-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Kosher], ingredientLines=[1/3 cup extra-virgin olive oil, plus more for drizzling, 1 cup finely chopped sweet onion, such as Vidalia, 4 large garlic cloves, smashed, Sea salt, 1 1/2 teaspoons ground cumin, 7 pounds tomatoes, cored and coarsely chopped, 2 cups chicken stock or canned low-sodium broth, Pinch of sugar, Freshly ground pepper, 1/4 cup coarsely chopped flat-leaf parsley, 1/4 cup coarsely chopped lovage or celery leaves, plus whole leaves for garnish], totalWeight=3949.533134124789, cuisineType=[indian], mealType=[lunch/dinner], dishType=[soup]], Recipe[label=Chicken Veggie Soup, dietLabels=[High-Fiber], healthLabels=[Dairy-Free, Gluten-Free, Wheat-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Crustacean-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher], ingredientLines=[1 tablespoon olive oil, Two 6-ounce boneless, skinless chicken breasts, cubed, 1 cup quinoa, rinsed, 2 stalks celery, chopped, 2 carrots, diced, 1 sweet potato, cubed, 1 small yellow onion, diced, 1 Yukon gold potato, cubed, Kosher salt and ground black pepper, 6 cups Beef Bone Broth, recipe follows, 1 teaspoon chopped fresh oregano, 1 teaspoon chopped fresh thyme, 1 teaspoon chopped fresh sage, 3 leaves kale, cut into ribbons, 4 pounds beef bones, including marrow, knuckles and feet, 1 tablespoon tomato paste, 2 carrots, roughly chopped, 2 stalks celery, roughly chopped, 1 head garlic, sliced in half, 1 yellow onion, cubed, 1 tablespoon peppercorns, 2 sprigs fresh thyme, 2 bay leaves], totalWeight=3447.221198045182, cuisineType=[american], mealType=[lunch/dinner], dishType=[soup]], Recipe[label=Chicken Paella, dietLabels=[High-Fiber], healthLabels=[Mediterranean, Dairy-Free, Gluten-Free, Wheat-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Red-Meat-Free, Crustacean-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher], ingredientLines=[1/4 cup olive oil, 1 tablespoon dark chili powder, 1/2 teaspoon ground cumin, 1/4 teaspoon ground coriander, 4 bone-in, skin-on chicken thighs, Kosher salt and freshly ground black pepper, 1/4 cup extra-virgin olive oil, 1/2 cup diced yellow onion, 1/2 cup diced red bell pepper, 1/4 cup diced celery, 2 sprigs fresh marjoram, 1 sprig fresh thyme, Kosher salt and freshly ground black pepper, 2 tablespoons minced garlic, 3/4 cup tomato puree, 2 cups long-grain rice, 4 cups chicken stock, 1/2 cup fresh cilantro leaves, chopped, 1 lemon, 2 ripe Hass avocados, sliced, for garnish, 1 cup chopped Castelvetrano olives, for garnish], totalWeight=3259.9803435101326, cuisineType=[mediterranean], mealType=[lunch/dinner], dishType=[main course]], Recipe[label=Chicken Jambalaya, dietLabels=[High-Fiber], healthLabels=[Mediterranean, Dairy-Free, Gluten-Free, Wheat-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Red-Meat-Free, Crustacean-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher], ingredientLines=[2 tablespoons canola oil, divided, 1 1/2 pounds boneless, skinless chicken thighs, cut into bite-size pieces, Kosher salt and freshly ground black pepper, 1 medium yellow onion, chopped, 1 green bell pepper, chopped, 2 stalks celery, chopped, 1 tablespoon chopped garlic, 1 tablespoon Cajun seasoning, 1/4 teaspoon cayenne pepper, 2 cups long grain rice, 3 cups chicken broth, One 14.5-ounce can diced tomatoes, with juice, 1 tablespoon chopped fresh parsley, for garnish], totalWeight=2551.045731637218, cuisineType=[mediterranean], mealType=[lunch/dinner], dishType=[main course]], Recipe[label=Slow-Cooker Chicken Gumbo, dietLabels=[], healthLabels=[Dairy-Free, Gluten-Free, Wheat-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Crustacean-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free], ingredientLines=[1 pound boneless skinless chicken breasts, cut into 2-inch pieces, One 10-ounce package frozen okra, thawed, 2 links andouille sausage, diced, 1 cup chopped onions, 2 celery stalks, chopped, 1 green bell pepper, seeded and chopped, 1 teaspoon dried thyme, 1 teaspoon dried oregano, 1/2 teaspoon salt, 2 bay leaves, 1/2 teaspoon onion powder, 1/2 teaspoon garlic powder, 1/2 teaspoon mustard powder, 1/4 teaspoon cayenne pepper, 1/4 teaspoon ground black pepper, 2 cups reduced-sodium chicken broth, 2 cups reduced-sodium tomato juice, 2 cups cooked rice], totalWeight=2522.351490138889, cuisineType=[american], mealType=[lunch/dinner], dishType=[main course]], Recipe[label=Italian Lemon Chicken Bowtie Pasta Salad, dietLabels=[High-Fiber], healthLabels=[Dairy-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Crustacean-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher], ingredientLines=[1 box of bowtie pasta, 1 large can of white meat chicken (12.5 oz), 1 large bundle of fresh asparagus, washed and cut into thirds, 1/2 onion, minced, 1 stalk celery, minced, 1 tomato, cut into small pieces, 1/3 cup lemon juice, 1/4 cup olive oil, 1 TBSP dried oregano, 1 tsp lemon pepper, 1 tsp minced garlic, salt to taste], totalWeight=1195.4646468990945, cuisineType=[italian], mealType=[lunch/dinner], dishType=[salad]], Recipe[label=Okra and Tomatoes recipes, dietLabels=[Low-Carb], healthLabels=[Pescatarian, Mediterranean, Dairy-Free, Gluten-Free, Wheat-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Red-Meat-Free, Crustacean-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher, Immuno-Supportive], ingredientLines=[5 Tbsp vegetable oil, 1 celery rib, sliced thin, 1/2 onion, sliced thin, 1 jalape?o chile, seeded, sliced thin, 3 garlic cloves, sliced thin, 1 Tbsp tomato paste, 2 Tbsp red wine vinegar, 1 1/2 cups chicken or vegetable broth (use vegetable broth for vegetarian version, and gluten-free broth for gluten-free version), 1 teaspoon minced fresh rosemary, 1/2 to 3/4 pound fresh okra, 5 plum tomatoes, diced, salt, pepper], totalWeight=1123.036861619184, cuisineType=[italian], mealType=[lunch/dinner], dishType=[main course]], Recipe[label=Andouille and Chicken Jambalaya, dietLabels=[High-Fiber, Low-Carb], healthLabels=[Dairy-Free, Gluten-Free, Wheat-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Crustacean-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free], ingredientLines=[2 tablespoons extra-virgin olive oil, plus more for drizzling, 2 3-ounce fully cooked andouille sausages, sliced 1/4 inch thick, 2 stalks celery, chopped, plus leaves for topping, 1 onion, chopped, 1 green bell pepper, chopped, Kosher salt, 2 tablespoons tomato paste, 1 teaspoon Cajun seasoning, 3/4 cup converted white rice, 1 15-ounce can diced fire-roasted tomatoes, 1 15-ounce can no-salt-added kidney beans, drained and rinsed, 1 1/2 cups shredded rotisserie chicken or leftover turkey (skin removed; about 8 ounces)], totalWeight=2732.4768095051472, cuisineType=[american], mealType=[lunch/dinner], dishType=[condiments and sauces]], Recipe[label=Chicken and Quinoa Soup, dietLabels=[Low-Carb], healthLabels=[Dairy-Free, Gluten-Free, Wheat-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Red-Meat-Free, Crustacean-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher], ingredientLines=[1? Tablespoon olive oil, 1 Cup shredded carrots, 1 Cup chopped yellow onions, ? Cup thinly sliced celery, ? Cup thinly sliced green onions, 1 14.5-ounce can no-salt-added diced tomatoes, drained, 1? Teaspoon dried cilantro, 1 Teaspoon ground black pepper, ? Teaspoon ground cumin, 10 Cups fat-free, low-sodium chicken broth, ? Cup quinoa, 1 rotisserie chicken, skin and bones removed, shredded], totalWeight=4570.418085312525, cuisineType=[south american], mealType=[lunch/dinner], dishType=[soup]], Recipe[label=Cod In Sweet Tomato Sauce II, dietLabels=[High-Protein], healthLabels=[Dairy-Free, Gluten-Free, Wheat-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Shellfish-Free, Pork-Free, Red-Meat-Free, Crustacean-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Kosher], ingredientLines=[2 teaspoons olive oil, 2 cups chopped onions, 1 cup chopped red bell peppers, 1 cup chopped celery, 2 cups chopped tomatoes, 2 teaspoons minced garlic, 1 teaspoon sugar, 1/4 cup reduced-sodium chicken broth, 1/4 teaspoon salt, 1/4 teaspoon ground black pepper, 1 1/2 pounds cod fillets], totalWeight=1629.263555, cuisineType=[french], mealType=[snack, lunch/dinner], dishType=[condiments and sauces]], Recipe[label=Fennel, Cherry Tomato & Chicken Salad with Toasted Pistachios recipes, dietLabels=[Low-Carb], healthLabels=[Keto-Friendly, Paleo, Mediterranean, DASH, Dairy-Free, Gluten-Free, Wheat-Free, Egg-Free, Peanut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Red-Meat-Free, Crustacean-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher], ingredientLines=[A few stems of fennel from the bulb you'll use for the salad below, 1 slice onion, 1 small stalk celery, 2 boneless skinless chicken thighs (about 10 ounces), salt, pepper, 2 cloves garlic, grated on a Microplane or minced with salt, 2 teaspoons red wine vinegar, 1 teaspoon Dijon mustard, 2 tablespoons olive oil, salt, 1 bulb fennel, core removed and very thinly sliced, preferably on a mandoline, ? pint cherry tomatoes, A few handfuls of lettuce--green or red leaf, or romaine, chopped, ? cup toasted pistachios, coarsely chopped], totalWeight=853.8337653398946, cuisineType=[mediterranean], mealType=[lunch/dinner], dishType=[salad]], Recipe[label=Chicken & Brown Rice, dietLabels=[], healthLabels=[Sugar-Conscious, DASH, Dairy-Free, Gluten-Free, Wheat-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Red-Meat-Free, Crustacean-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher], ingredientLines=[1 1/2 tsp olive oil, 1 lb chicken breast (or 1 c cooked and chopped), 1 large carrot, diced, 1 celery stalk, diced, 1/4 leek or scallion, thinly sliced, 1/3 C brown rice, 2 tsp thyme, 1 can (14.5 oz) no-salt-added diced tomatoes, including juice, 6 C low-sodium chicken stock], totalWeight=2491.816010868056, cuisineType=[french], mealType=[lunch/dinner], dishType=[main course]], Recipe[label=Soup Recipe: Italian Bread & Tomato Soup (Ribollita), dietLabels=[High-Fiber], healthLabels=[Mediterranean, Dairy-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Red-Meat-Free, Crustacean-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher], ingredientLines=[2 tablespoons olive oil, 4 large garlic cloves, chopped, 1 medium onion, chopped, 2 medium carrots, peeled and chopped, 2 large celery ribs, chopped, 1 dried bay leaf, 2 15.5-ounce cans cannellini beans, with their liquid, 6 cups vegetable or chicken stock, 1 15-ounce can (1 3/4 cups) tomato pure?, 9 ounces day-old bread, torn in pieces (about 3 cups), 1/4 cup fresh basil, chopped], totalWeight=3384.823771875, cuisineType=[italian], mealType=[lunch/dinner], dishType=[soup]], Recipe[label=Chicken & Sausage Gumbo, dietLabels=[], healthLabels=[Sugar-Conscious, Dairy-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Red-Meat-Free, Crustacean-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher], ingredientLines=[? cup all-purpose flour, 1 (14.5 ounce) can reduced-sodium chicken broth, 12 ounces skinless, boneless chicken breast halves, cut into cubes, 1 large red or green sweet pepper, seeded and coarsely chopped, 1 large onion, coarsely chopped, 1 cup water, 1 stalk celery, sliced, 4 cloves garlic, minced, 1 teaspoon salt-free Cajun seasoning, 1 14.8-ounce pouch cooked brown rice, 1 10-ounce package frozen cut okra, 8 ounces smoked turkey sausage, sliced, 1 large tomato, chopped], totalWeight=2324.631629886409, cuisineType=[american], mealType=[lunch/dinner], dishType=[main course]], Recipe[label=Chicken Chili Monterey, dietLabels=[], healthLabels=[Mediterranean, Dairy-Free, Gluten-Free, Wheat-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Red-Meat-Free, Crustacean-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher], ingredientLines=[1 tablespoon cooking oil, 1 cup chopped onion, 1 cup coarsely chopped carrots, 1 cup sliced celery, 1? cups chopped tart apples, 2 teaspoons curry powder, or more to taste, ? teaspoon salt, 3 cups reduced-sodium chicken broth, 3 cups water, 1 (14.1 ounce) can low-sodium stewed tomatoes, 2 cups chopped cooked chicken or turkey], totalWeight=2663.326329710318, cuisineType=[american], mealType=[lunch/dinner], dishType=[main course]], Recipe[label=Moroccan chicken soup from Cayenne, dietLabels=[], healthLabels=[Mediterranean, Dairy-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Red-Meat-Free, Crustacean-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher], ingredientLines=[1 tablespoon olive oil, 1 red onion, finely chopped, 2 cloves garlic, finely chopped, 2 carrots, diced, 1 stalk celery, diced, 1 cooked boneless and skinless chicken breast, diced (about 2 cups), 1 cup cooked garbanzo beans, 1/3 cup diced tomato, 2 bay leaves, 1 teaspoon basil, 1/2 teaspoon curry powder, 1/2 teaspoon cinnamon, Salt and pepper to taste, 1/4 cup cracked wheat no. 1 (fine grind), 4 to 5 cups chicken broth, more if desired], totalWeight=2141.588542351933, cuisineType=[middle eastern], mealType=[lunch/dinner], dishType=[soup]], Recipe[label=Double-Dark Chicken Noodle Soup recipes, dietLabels=[Low-Carb], healthLabels=[Mediterranean, Dairy-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Red-Meat-Free, Crustacean-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher], ingredientLines=[1 leek, Stems from ? bunch parsley, 6 sprigs thyme, 2 bay leaves, 1 tablespoon vegetable oil, 3 pounds chicken wings, 1 onion, unpeeled, quartered, 3 carrots, peeled, 2 celery stalks, 2 garlic cloves, 1 tablespoon tomato paste, ? teaspoon black peppercorns, ground black pepper, kosher salt, 2? pounds bone-in chicken thighs, skin removed, 8 ounces carrots, peeled, sliced ?� thick, 8 ounces pearl onions, peeled, halved through root, 8 ounces egg noodles, fresh chervil], totalWeight=3775.133096774682, cuisineType=[asian], mealType=[lunch/dinner], dishType=[soup]], Recipe[label=Butcher Shop Chicken, dietLabels=[Low-Carb], healthLabels=[Paleo, Mediterranean, Dairy-Free, Gluten-Free, Wheat-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Red-Meat-Free, Crustacean-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher], ingredientLines=[2 shallots, 1 carrot, 1 celery rib, 2 bone-in chicken breast halves, 2 whole chicken legs, 3 tbsp. extra-virgin olive oil, kosher salt, Black pepper, 1? tsp. finely chopped rosemary leaves, 1 tsp. finely chopped thyme leaves, 3 tbsp. finely chopped basil leaves, 1 clove garlic, 2 pt. grape tomatoes, ? tsp. crushed red pepper, 1 tsp. sherry vinegar], totalWeight=1749.6119000728665, cuisineType=[american], mealType=[lunch/dinner], dishType=[main course]], Recipe[label=Double-Dark Chicken Noodle Soup, dietLabels=[Low-Carb], healthLabels=[Mediterranean, Dairy-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Red-Meat-Free, Crustacean-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher], ingredientLines=[1 leek, Stems from 1/2 bunch parsley, 6 sprigs thyme, 2 bay leaves, 1 tablespoon vegetable oil, 3 pounds chicken wings, 1 onion, unpeeled, quartered, 3 carrots, peeled, 2 celery stalks, 2 garlic cloves, 1 tablespoon tomato paste, 1/2 teaspoon black peppercorns, Kosher salt, freshly ground pepper, 2 1/2 pounds bone-in chicken thighs, skin removed, 8 ounces carrots, peeled, sliced 1/2\" thick, 8 ounces pearl onions, peeled,, halved through root, 8 ounces egg noodles, Fresh chervil (for serving)], totalWeight=3763.938592151659, cuisineType=[asian], mealType=[lunch/dinner], dishType=[soup]], Recipe[label=Chicken Spaghetti Dinner, dietLabels=[], healthLabels=[Mediterranean, Dairy-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Red-Meat-Free, Crustacean-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher], ingredientLines=[1 green pepper, chopped, 1 cup diced celery, 2 large onions, chopped, 3 cloves garlic, chopped, 1/2 cup cooking oil, 1 can (16 ounces) tomato puree, 2 cans (6 ounces each) tomato paste, 2 puree cans water (32 ounces), 1 cup up broiler-fryer, 1 teaspoon cinnamon, 1 teaspoon salt, 1/2 teaspoon pepper, 1/2 teaspoon allspice, 8 ounces spaghetti], totalWeight=2714.0564613888887, cuisineType=[italian], mealType=[lunch/dinner], dishType=[main course]], Recipe[label=Garden Tomato Soup With Cumin, dietLabels=[High-Fiber], healthLabels=[Dairy-Free, Gluten-Free, Wheat-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Red-Meat-Free, Crustacean-Free, Celery-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Kosher], ingredientLines=[1/3 cup extra-virgin olive oil, plus more for drizzling, 1 cup finely chopped sweet onion, such as Vidalia, 4 large garlic cloves, smashed, Sea salt, 1 1/2 teaspoons ground cumin, 7 pounds tomatoes, cored and coarsely chopped, 2 cups chicken stock or canned low-sodium broth, Pinch of sugar, Freshly ground pepper, 1/4 cup coarsely chopped flat-leaf parsley, 1/4 cup coarsely chopped lovage or celery leaves, plus whole leaves for garnish], totalWeight=3949.533134124789, cuisineType=[indian], mealType=[lunch/dinner], dishType=[soup]], Recipe[label=Chicken Veggie Soup, dietLabels=[High-Fiber], healthLabels=[Dairy-Free, Gluten-Free, Wheat-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Crustacean-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher], ingredientLines=[1 tablespoon olive oil, Two 6-ounce boneless, skinless chicken breasts, cubed, 1 cup quinoa, rinsed, 2 stalks celery, chopped, 2 carrots, diced, 1 sweet potato, cubed, 1 small yellow onion, diced, 1 Yukon gold potato, cubed, Kosher salt and ground black pepper, 6 cups Beef Bone Broth, recipe follows, 1 teaspoon chopped fresh oregano, 1 teaspoon chopped fresh thyme, 1 teaspoon chopped fresh sage, 3 leaves kale, cut into ribbons, 4 pounds beef bones, including marrow, knuckles and feet, 1 tablespoon tomato paste, 2 carrots, roughly chopped, 2 stalks celery, roughly chopped, 1 head garlic, sliced in half, 1 yellow onion, cubed, 1 tablespoon peppercorns, 2 sprigs fresh thyme, 2 bay leaves], totalWeight=3447.221198045182, cuisineType=[american], mealType=[lunch/dinner], dishType=[soup]], Recipe[label=Chicken Paella, dietLabels=[High-Fiber], healthLabels=[Mediterranean, Dairy-Free, Gluten-Free, Wheat-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Red-Meat-Free, Crustacean-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher], ingredientLines=[1/4 cup olive oil, 1 tablespoon dark chili powder, 1/2 teaspoon ground cumin, 1/4 teaspoon ground coriander, 4 bone-in, skin-on chicken thighs, Kosher salt and freshly ground black pepper, 1/4 cup extra-virgin olive oil, 1/2 cup diced yellow onion, 1/2 cup diced red bell pepper, 1/4 cup diced celery, 2 sprigs fresh marjoram, 1 sprig fresh thyme, Kosher salt and freshly ground black pepper, 2 tablespoons minced garlic, 3/4 cup tomato puree, 2 cups long-grain rice, 4 cups chicken stock, 1/2 cup fresh cilantro leaves, chopped, 1 lemon, 2 ripe Hass avocados, sliced, for garnish, 1 cup chopped Castelvetrano olives, for garnish], totalWeight=3259.9803435101326, cuisineType=[mediterranean], mealType=[lunch/dinner], dishType=[main course]], Recipe[label=Chicken Jambalaya, dietLabels=[High-Fiber], healthLabels=[Mediterranean, Dairy-Free, Gluten-Free, Wheat-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Red-Meat-Free, Crustacean-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher], ingredientLines=[2 tablespoons canola oil, divided, 1 1/2 pounds boneless, skinless chicken thighs, cut into bite-size pieces, Kosher salt and freshly ground black pepper, 1 medium yellow onion, chopped, 1 green bell pepper, chopped, 2 stalks celery, chopped, 1 tablespoon chopped garlic, 1 tablespoon Cajun seasoning, 1/4 teaspoon cayenne pepper, 2 cups long grain rice, 3 cups chicken broth, One 14.5-ounce can diced tomatoes, with juice, 1 tablespoon chopped fresh parsley, for garnish], totalWeight=2551.045731637218, cuisineType=[mediterranean], mealType=[lunch/dinner], dishType=[main course]], Recipe[label=Slow-Cooker Chicken Gumbo, dietLabels=[], healthLabels=[Dairy-Free, Gluten-Free, Wheat-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Crustacean-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free], ingredientLines=[1 pound boneless skinless chicken breasts, cut into 2-inch pieces, One 10-ounce package frozen okra, thawed, 2 links andouille sausage, diced, 1 cup chopped onions, 2 celery stalks, chopped, 1 green bell pepper, seeded and chopped, 1 teaspoon dried thyme, 1 teaspoon dried oregano, 1/2 teaspoon salt, 2 bay leaves, 1/2 teaspoon onion powder, 1/2 teaspoon garlic powder, 1/2 teaspoon mustard powder, 1/4 teaspoon cayenne pepper, 1/4 teaspoon ground black pepper, 2 cups reduced-sodium chicken broth, 2 cups reduced-sodium tomato juice, 2 cups cooked rice], totalWeight=2522.351490138889, cuisineType=[american], mealType=[lunch/dinner], dishType=[main course]], Recipe[label=Italian Lemon Chicken Bowtie Pasta Salad, dietLabels=[High-Fiber], healthLabels=[Dairy-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Crustacean-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher], ingredientLines=[1 box of bowtie pasta, 1 large can of white meat chicken (12.5 oz), 1 large bundle of fresh asparagus, washed and cut into thirds, 1/2 onion, minced, 1 stalk celery, minced, 1 tomato, cut into small pieces, 1/3 cup lemon juice, 1/4 cup olive oil, 1 TBSP dried oregano, 1 tsp lemon pepper, 1 tsp minced garlic, salt to taste], totalWeight=1195.4646468990945, cuisineType=[italian], mealType=[lunch/dinner], dishType=[salad]], Recipe[label=Okra and Tomatoes recipes, dietLabels=[Low-Carb], healthLabels=[Pescatarian, Mediterranean, Dairy-Free, Gluten-Free, Wheat-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Red-Meat-Free, Crustacean-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher, Immuno-Supportive], ingredientLines=[5 Tbsp vegetable oil, 1 celery rib, sliced thin, 1/2 onion, sliced thin, 1 jalape?o chile, seeded, sliced thin, 3 garlic cloves, sliced thin, 1 Tbsp tomato paste, 2 Tbsp red wine vinegar, 1 1/2 cups chicken or vegetable broth (use vegetable broth for vegetarian version, and gluten-free broth for gluten-free version), 1 teaspoon minced fresh rosemary, 1/2 to 3/4 pound fresh okra, 5 plum tomatoes, diced, salt, pepper], totalWeight=1123.036861619184, cuisineType=[italian], mealType=[lunch/dinner], dishType=[main course]], Recipe[label=Andouille and Chicken Jambalaya, dietLabels=[High-Fiber, Low-Carb], healthLabels=[Dairy-Free, Gluten-Free, Wheat-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Crustacean-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free], ingredientLines=[2 tablespoons extra-virgin olive oil, plus more for drizzling, 2 3-ounce fully cooked andouille sausages, sliced 1/4 inch thick, 2 stalks celery, chopped, plus leaves for topping, 1 onion, chopped, 1 green bell pepper, chopped, Kosher salt, 2 tablespoons tomato paste, 1 teaspoon Cajun seasoning, 3/4 cup converted white rice, 1 15-ounce can diced fire-roasted tomatoes, 1 15-ounce can no-salt-added kidney beans, drained and rinsed, 1 1/2 cups shredded rotisserie chicken or leftover turkey (skin removed; about 8 ounces)], totalWeight=2732.4768095051472, cuisineType=[american], mealType=[lunch/dinner], dishType=[condiments and sauces]], Recipe[label=Chicken and Quinoa Soup, dietLabels=[Low-Carb], healthLabels=[Dairy-Free, Gluten-Free, Wheat-Free, Egg-Free, Peanut-Free, Tree-Nut-Free, Soy-Free, Fish-Free, Shellfish-Free, Pork-Free, Red-Meat-Free, Crustacean-Free, Mustard-Free, Sesame-Free, Lupine-Free, Mollusk-Free, Alcohol-Free, Sulfite-Free, Kosher], ingredientLines=[1? Tablespoon olive oil, 1 Cup shredded carrots, 1 Cup chopped yellow onions, ? Cup thinly sliced celery, ? Cup thinly sliced green onions, 1 14.5-ounce can no-salt-added diced tomatoes, drained, 1? Teaspoon dried cilantro, 1 Teaspoon ground black pepper, ? Teaspoon ground cumin, 10 Cups fat-free, low-sodium chicken broth, ? Cup quinoa, 1 rotisserie chicken, skin and bones removed, shredded], totalWeight=4570.418085312525, cuisineType=[south american], mealType=[lunch/dinner], dishType=[soup]]]";
        var result =  searcher.getRecipes(keyWords, healthSet, mealTypes);
        assertEquals(expected.length(), result.toString().length(), "Collection of recipes should be the same as the expected!");

        verify(client, times(2)).send(captor.capture(), any());
        assertTrue(captor.getValue().uri().toString().contains("chicken"), "Captor should contains chicken in the uri of the request!");
        assertTrue(captor.getValue().uri().toString().contains("tomato"), "Captor should contains tomato in the uri of the request!");
        assertTrue(captor.getValue().uri().toString().contains("celery"), "Captor should contains celery in the uri of the request!");
        assertTrue(captor.getValue().uri().toString().contains("alcohol-free"), "Captor should contains alcohol-free in the uri of the request!");
        assertTrue(captor.getValue().uri().toString().contains("pork-free"), "Captor should contains pork-free in the uri of the request!");
        assertTrue(captor.getValue().uri().toString().contains("dairy-free"), "Captor should contains dairy-free in the uri of the request!");
        assertTrue(captor.getValue().uri().toString().contains("Lunch"), "Captor should contains Lunch in the uri of the request!");
        assertTrue(captor.getValue().uri().toString().contains("Dinner"), "Captor should contains Dinner in the uri of the request!");
    }
}
